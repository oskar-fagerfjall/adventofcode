# This reads like a variation on cell automata, the Game of Life.
# Make a map structure, where for each cell you can query its state and how many
#  active neighbors it has. Perhaps as nextstate = rules(current).